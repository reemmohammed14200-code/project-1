<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ุงูุฎุฑูุทุฉ</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    body { font-family: Arial; margin: 0; padding: 0; background-color: #f2f2f2; }
    h2 { text-align: center; margin-top: 20px; }
    #map { height: 90vh; width: 95vw; margin: auto; border-radius: 10px; }
  </style>
</head>
<body>

<h2>ุงูุฎุฑูุทุฉ</h2>
<div id="map"></div>

<!-- ููุชุจุฉ Leaflet.js -->
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
const startPoint = [18.4729636, 42.4155847];
const destination = [18.4196375, 42.4577191];
const orsApiKey = "eyJvcmciOiI1YjNjZTM1OTc4NTExMTAwMDFjZjYyNDgiLCJpZCI6ImQyMWY4YzRkMWM1NjRlYzhiYzNmNTYwYmEzYmRlYmQwIiwiaCI6Im11cm11cjY0In0=";

const map = L.map('map').setView(startPoint, 13);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: 'ยฉ OpenStreetMap'
}).addTo(map);

L.marker(startPoint).addTo(map).bindPopup('๐ ููุทุฉ ุงูููุงูุฉ').openPopup();
L.marker(destination).addTo(map).bindPopup('๐ ููุทุฉ ุงูุจุฏุงูุฉ');

// ุฌูุจ ุงููุณุงุฑ ูู OpenRouteService
fetch(`https://api.openrouteservice.org/v2/directions/driving-car?api_key=${orsApiKey}&start=${startPoint[1]},${startPoint[0]}&end=${destination[1]},${destination[0]}`)
  .then(response => response.json())
  .then(data => {
    const coords = data.features[0].geometry.coordinates;
    const latlngs = coords.map(coord => [coord[1], coord[0]]);
    L.polyline(latlngs, { color: 'green', weight: 5 }).addTo(map);
    map.fitBounds(L.polyline(latlngs).getBounds());
  })
  .catch(error => {
    console.error("๐ซ ุฎุทุฃ ูู ุฌูุจ ุงููุณุงุฑ:", error);
    alert("ุชุนุฐุฑ ุชุญููู ุงูุทุฑูู ุงูุญููููุ ุณูุชู ุฑุณู ุฎุท ูุจุงุดุฑ.");
    L.polyline([startPoint, destination], { color: 'orange', dashArray: '5,5' }).addTo(map);
  });

// ๐ต ุชุญุฏูุฏ ูููุน ุงููุณุชุฎุฏู ุงูุญุงูู
if (navigator.geolocation) {
  navigator.geolocation.getCurrentPosition(
    (position) => {
      const userLatLng = [position.coords.latitude, position.coords.longitude];

      // ุฑุณู ุนูุงูุฉ ุนูู ุงููููุน ุงูุญุงูู
      const currentIcon = L.divIcon({
        className: 'custom-marker',
        html: '๐',
        iconSize: [30, 30],
        iconAnchor: [15, 15]
      });

      L.marker(userLatLng, { icon: currentIcon })
        .addTo(map)
        .bindPopup('๐ ูููุนู ุงูุญุงูู')
        .openPopup();

      console.log('โ ุชู ุชุญุฏูุฏ ุงููููุน ุงูุญุงูู:', userLatLng);
    },
    (error) => {
      console.warn('โ ุชุนุฐุฑ ุงูุญุตูู ุนูู ุงููููุน:', error.message);
      alert('ุชุนุฐุฑ ุงูุญุตูู ุนูู ูููุนู ุงูุญุงูู. ุชุฃูุฏ ูู ุชูุนูู ุงููููุน.');
    }
  );
} else {
  alert("ุงููุชุตูุญ ูุง ูุฏุนู ุชุญุฏูุฏ ุงููููุน ุงูุฌุบุฑุงูู.");
}

</script>


</body>
</html>
